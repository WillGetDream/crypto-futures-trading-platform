<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æœç´¢ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .container {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        .result {
            margin: 10px 0;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .success { background: #4CAF50; color: white; }
        .error { background: #f44336; color: white; }
        .info { background: #2196F3; color: white; }
        input {
            padding: 10px;
            width: 200px;
            margin-right: 10px;
            background: #333;
            color: white;
            border: 1px solid #555;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æœç´¢ä¿®å¤æµ‹è¯•</h1>
        
        <div class="info">
            <strong>æµ‹è¯•è¯´æ˜ï¼š</strong> æµ‹è¯•æœç´¢åŠŸèƒ½æ˜¯å¦è¿˜ä¼šé—ªçƒå’Œæ˜¾ç¤ºé”™è¯¯å†…å®¹ã€‚
        </div>
        
        <div class="mb-4">
            <input
                type="text"
                id="searchInput"
                placeholder="è¾“å…¥ NQ æµ‹è¯•"
                value="NQ"
            />
            <button onclick="testSearch()">æµ‹è¯•æœç´¢</button>
            <button onclick="clearTest()">æ¸…é™¤æµ‹è¯•</button>
        </div>

        <div class="mb-4">
            <button onclick="testAutoSearch()">æµ‹è¯•è‡ªåŠ¨æœç´¢</button>
            <button onclick="resetLocalStorage()">é‡ç½®æœ¬åœ°å­˜å‚¨</button>
        </div>
        
        <div id="result"></div>
    </div>

    <script>
        let searchCount = 0;

        async function testSearch() {
            const symbol = document.getElementById('searchInput').value.trim();
            if (!symbol) {
                showResult('è¯·è¾“å…¥åˆçº¦ç¬¦å·', 'error');
                return;
            }

            searchCount++;
            showResult(`ç¬¬ ${searchCount} æ¬¡æœç´¢: ${symbol}`, 'info');
            
            // æ¨¡æ‹Ÿæœç´¢å»¶è¿Ÿ
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // æ¨¡æ‹Ÿæœç´¢ç»“æœ
            const results = {
                'NQ': [
                    { symbol: 'NQ', description: 'E-mini NASDAQ 100 DEC25', conid: '563947738' },
                    { symbol: 'NQ', description: 'E-mini NASDAQ 100 SEP25', conid: '691171690' }
                ],
                'MES': [
                    { symbol: 'MES', description: 'Micro E-Mini S&P 500 DEC25', conid: '730283085' },
                    { symbol: 'MES', description: 'Micro E-Mini S&P 500 SEP25', conid: '711280067' }
                ],
                'MNQ': [
                    { symbol: 'MNQ', description: 'Micro E-Mini Nasdaq-100 DEC25', conid: '730283094' },
                    { symbol: 'MNQ', description: 'Micro E-Mini Nasdaq-100 SEP25', conid: '711280073' }
                ]
            };

            const upperSymbol = symbol.toUpperCase();
            const foundResults = results[upperSymbol] || [];
            
            if (foundResults.length > 0) {
                let html = `âœ… æ‰¾åˆ° ${foundResults.length} ä¸ª ${upperSymbol} åˆçº¦:\n`;
                foundResults.forEach(contract => {
                    html += `- ${contract.description} (ID: ${contract.conid})\n`;
                });
                showResult(html, 'success');
            } else {
                showResult(`âŒ æœªæ‰¾åˆ° ${upperSymbol} åˆçº¦`, 'error');
            }
        }

        function testAutoSearch() {
            showResult('æµ‹è¯•è‡ªåŠ¨æœç´¢åŠŸèƒ½...\nè¿™åº”è¯¥åªåœ¨é¡µé¢é¦–æ¬¡åŠ è½½æ—¶æ‰§è¡Œä¸€æ¬¡', 'info');
        }

        function clearTest() {
            searchCount = 0;
            document.getElementById('searchInput').value = '';
            showResult('æµ‹è¯•å·²æ¸…é™¤', 'info');
        }

        function resetLocalStorage() {
            localStorage.removeItem('searchManagerInitialized');
            showResult('æœ¬åœ°å­˜å‚¨å·²é‡ç½®ï¼Œä¸‹æ¬¡åŠ è½½æ—¶ä¼šé‡æ–°æ‰§è¡Œè‡ªåŠ¨æœç´¢', 'success');
        }

        function showResult(message, type) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<div class="result ${type}">${message}</div>`;
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºè¯´æ˜
        window.onload = function() {
            showResult('é¡µé¢åŠ è½½å®Œæˆã€‚\n1. è¾“å…¥ NQ å¹¶ç‚¹å‡»æµ‹è¯•æœç´¢\n2. è§‚å¯Ÿæ˜¯å¦è¿˜ä¼šæ˜¾ç¤º MES çš„ç»“æœ\n3. å¦‚æœæ­£å¸¸æ˜¾ç¤º NQ çš„ç»“æœï¼Œè¯´æ˜ä¿®å¤æˆåŠŸ', 'info');
        };
    </script>
</body>
</html> 